<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ“‹ Kanban Calendar Board</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <script src="https://cdn.jsdelivr.net/npm/sortablejs@latest/Sortable.min.js"></script>
</head>
<body>
    <div id="projectGate" class="project-gate">
        <div class="project-gate-card">
            <span id="projectGateClose" class="close project-gate-close">&times;</span>
            <h2>í”„ë¡œì íŠ¸ ì„ íƒ</h2>
            <p class="project-gate-subtitle">ì ‘ì†í•  í”„ë¡œì íŠ¸ë¥¼ ê³ ë¥´ê³  ë¹„ë°€ë²ˆí˜¸ 4ìë¦¬ë¥¼ ì…ë ¥í•˜ì„¸ìš”.</p>
            <div class="project-gate-field">
                <label for="projectSelect">í”„ë¡œì íŠ¸</label>
                <select id="projectSelect"></select>
            </div>
            <div class="project-gate-field">
                <label for="projectPin">ë¹„ë°€ë²ˆí˜¸ (4ìë¦¬)</label>
                <input type="password" id="projectPin" maxlength="4" inputmode="numeric" pattern="[0-9]{4}" autocomplete="one-time-code">
            </div>
            <button id="projectEnterBtn" class="btn-primary">ì ‘ì†</button>
            <div id="projectError" class="project-error"></div>
        </div>
    </div>
    <header>
        <h1>ğŸ“‹ Kanban Calendar Board</h1>
        <div class="header-actions">
            <span id="currentProjectBadge" class="project-badge">í”„ë¡œì íŠ¸ ì„ íƒ í•„ìš”</span>
            <button id="switchProjectBtn" class="btn-secondary">í”„ë¡œì íŠ¸ ë³€ê²½</button>
            <div class="nav-tabs">
                <a href="/" class="nav-tab active">ğŸ“Œ í™œì„± ì‘ì—…</a>
                <a href="/archive" class="nav-tab">ğŸ“¦ ë³´ê´€í•¨</a>
            </div>
            <button id="toggleViewBtn" class="btn-secondary">ğŸ“… ë‹¬ë ¥ ë³´ê¸°</button>
            <button id="addCardBtn" class="btn-primary">â• ì¹´ë“œ ì¶”ê°€</button>
        </div>
    </header>

    <!-- ë‹¬ë ¥ ì„¹ì…˜ -->
    <section id="calendarSection" class="calendar-section">
        <div class="calendar-header">
            <button id="prevMonth" class="btn-month">â—€</button>
            <h2 id="currentMonth"></h2>
            <button id="nextMonth" class="btn-month">â–¶</button>
            
            <div class="view-controls">
                <button id="monthViewBtn" class="view-btn">ì›”ë³„</button>
                <button id="weekViewBtn" class="view-btn active">ì£¼ë³„</button>
            </div>
        </div>
        <div class="calendar-grid" id="calendarGrid">
            <div class="calendar-day-header">ì¼</div>
            <div class="calendar-day-header">ì›”</div>
            <div class="calendar-day-header">í™”</div>
            <div class="calendar-day-header">ìˆ˜</div>
            <div class="calendar-day-header">ëª©</div>
            <div class="calendar-day-header">ê¸ˆ</div>
            <div class="calendar-day-header">í† </div>
        </div>
    </section>

    <!-- ì¹¸ë°˜ ì„¹ì…˜ (1ê°œë§Œ!) -->
    <section id="kanbanSection" class="kanban-section">
        <div class="kanban-container">
            <div class="kanban-column">
                <h2>ğŸ“ To Do</h2>
                <div class="cards-container" id="todo-cards" data-column="todo"></div>
            </div>
            <div class="kanban-column">
                <h2>ğŸš€ In Progress</h2>
                <div class="cards-container" id="inprogress-cards" data-column="inprogress"></div>
            </div>
            <div class="kanban-column">
                <h2>âœ… Done</h2>
                <div class="cards-container" id="done-cards" data-column="done"></div>
            </div>
        </div>
    </section>

    <!-- ì¹´ë“œ ì¶”ê°€ ëª¨ë‹¬ -->
    <div id="cardModal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h2>ìƒˆ ì¹´ë“œ ì¶”ê°€</h2>
            <form id="cardForm">
                <input type="text" id="title" placeholder="ì œëª©" required>
                <textarea id="description" placeholder="ì„¤ëª…"></textarea>
                <input type="text" id="gitIssue" placeholder="Git ì´ìŠˆ ë²ˆí˜¸">
                <input type="text" id="assignee" placeholder="ë‹´ë‹¹ì">
                <input type="text" id="label" placeholder="ë¼ë²¨">
                
                <select id="issueType" required>
                    <option value="story">ğŸ“– Story</option>
                    <option value="task">âœ… Task</option>
                    <option value="bug">ğŸ› Bug</option>
                </select>
                
                <select id="priority" required>
                    <option value="highest">ğŸ”´ Highest</option>
                    <option value="high">ğŸŸ  High</option>
                    <option value="medium" selected>ğŸŸ¡ Medium</option>
                    <option value="low">ğŸŸ¢ Low</option>
                    <option value="lowest">ğŸ”µ Lowest</option>
                </select>
                
                <!-- ì‹œì‘ì¼/ì¢…ë£Œì¼ ì¶”ê°€ -->
                <label for="startDate">ì‹œì‘ì¼</label>
                <input type="date" id="startDate" name="startDate">

                <label for="dueDate">ì¢…ë£Œì¼</label>
                <input type="date" id="dueDate" name="dueDate">
                
                <select id="columnName" required>
                    <option value="todo">To Do</option>
                    <option value="inprogress">In Progress</option>
                    <option value="done">Done</option>
                </select>
                
                <button type="submit" class="btn-primary">ì¶”ê°€</button>
            </form>

        </div>
    </div>

    <!-- ì¹´ë“œ ìƒì„¸ ëª¨ë‹¬ -->
    <div id="detailModal" class="modal">
    <div class="modal-content modal-large">
        <div id="detailContent"></div>
    </div>
</div>

<!-- ì¹´ë“œ ìˆ˜ì • ëª¨ë‹¬ -->
<div id="editModal" class="modal">
    <div class="modal-content">
        <span class="close" id="closeEdit">&times;</span>
        <h2>ì¹´ë“œ ìˆ˜ì •</h2>
        <form id="editForm">
            <input type="hidden" id="editCardId">
            <input type="text" id="editTitle" placeholder="ì œëª©" required>
            <textarea id="editDescription" placeholder="ì„¤ëª…"></textarea>
            <input type="text" id="editGitIssue" placeholder="Git ì´ìŠˆ ë²ˆí˜¸">
            <input type="text" id="editAssignee" placeholder="ë‹´ë‹¹ì">
            <input type="text" id="editLabel" placeholder="ë¼ë²¨">
            
            <select id="editIssueType" required>
                <option value="story">ğŸ“– Story</option>
                <option value="task">âœ… Task</option>
                <option value="bug">ğŸ› Bug</option>
            </select>
            
            <select id="editPriority" required>
                <option value="highest">ğŸ”´ Highest</option>
                <option value="high">ğŸŸ  High</option>
                <option value="medium">ğŸŸ¡ Medium</option>
                <option value="low">ğŸŸ¢ Low</option>
                <option value="lowest">ğŸ”µ Lowest</option>
            </select>
            
            <label for="editStartDate">ì‹œì‘ì¼</label>
            <input type="date" id="editStartDate">
            
            <label for="editDueDate">ì¢…ë£Œì¼</label>
            <input type="date" id="editDueDate">
            
            <select id="editColumnName" required>
                <option value="todo">To Do</option>
                <option value="inprogress">In Progress</option>
                <option value="done">Done</option>
            </select>
            
            <button type="submit" class="btn-primary">ì €ì¥</button>
        </form>
    </div>
</div>

    <script>
        window.SUPABASE_URL = "{{ supabase_url }}";
        window.SUPABASE_KEY = "{{ supabase_key }}";
    </script>
    <script src="{{ url_for('static', filename='js/app.js') }}"></script>
</body>
</html>
